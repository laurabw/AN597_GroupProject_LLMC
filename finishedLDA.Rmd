---
title: "Group Project"
author: "Laura Angley, Laura Brubaker-Wittman, Christian Gagnon, Mel Zarate"
date: "11/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##LDA##

(Insert explanation and pics from the google doc)

Packages we need: 
```{r}
library(curl)
library(MASS)
library(ggplot2)
```

##CHALLENGE##

Let's load in the data. We're going to use the Kamala and Cooper dataset, but, for the sake of simplicity, this dataset only includes the primate families Atelidae, Cebidae, and two genera of Cercopithecidae (macaques and mandrills). The dataset also includes five numeric variables: mean species brain size, mean female brain size, mean male body mass, mean female body mass, and mass dimorphism. Furthermore, we took out any species within these families that did not have values for any of the variables. 

(insert primate pics!)

Let's do it! 

Load in the data... 
```{r}
f <- curl("https://raw.githubusercontent.com/laurabw/AN597_GroupProject_LLMC/master/kamcoop.simplified.2.csv")
d <- read.csv(f, header = TRUE, sep = ",", stringsAsFactors = TRUE)
head(d)
summary(d)
str(d) # There are 3 different families, this is probably what we will use for the analysis
plot(d$Family, d$Body_mass_male_mean) #plot mass and male body mass so we can start to see what differences we may be looking for 
```
This simple boxplot just shows what we will be looking for in the LDA; in terms of male body mass, Cercopithecidae and Atelidae are close to one another, but species within Cebidae are a bit smaller. 


LDA
Now we're going to look for this difference in body mass (male and female) using an LDA. We will do this by simpling running the lda() wrapper function from the MASS package. 
```{r}
kamcoop.lda <- lda(Family ~ Body_mass_male_mean + Body_mass_female_mean, data = d) #categorical dependent variable is family 
kamcoop.lda
```
Output gives: group means, LD coefficients (lines that actually discriminate between the variables), prior proabilities of groups (what proportion of the data seemed to be in each group prior to starting), the proportion of trace is the percentage of separation achieved by each discriminant function (91% and 9%).

Now we can generate prediction values based on the LDA function and store it in an object by passing the model through the predict() function. The length of the value predicted will be correspond with the length of the processed data.

```{r}
lda.predict <- predict(kamcoop.lda)
lda.predict
```
 
 These prediction values can also help us look at the accuracy of the LDA by creating a table between the predicted classes (families based off predicted values) and the actual families from the data.  
 
```{r}
lda.predict.class <- predict(kamcoop.lda,
                       newdata=d[,c(7,8)]
                       )$class #find prediction values of class
lda.predict.class #gives the classifications that are in the predictions
#determine how well the model fits by comparing predictions to 
table(lda.predict.class, d[,2])
``` 
 This is a cross-tabulation of the real families and the predicted families. This basically is saying how many "Atelidae" were predicted to be "Atelidae" and so on. Based off of our table, our's is okay but not great. Only 6/12 Atelidae were correctly classified and 6 Cercopithecidae were misclassified as Atelidae. 
 
 
 ##Visualize LDA 
 
 One way we can visualize the output of the LDA is to plot the predicted linear discriminants for each family on stacked histograms.
 
```{r}
ldahist(lda.predict$x[,1], g = d$Family)
ldahist(lda.predict$x[,2], g = d$Family)
```
 
As we saw earlier, Cercopithecidae has the most variance and is a bit all over the place for the first discriminant. So we can expect that they won't group together that well in a scatter plot. In the second, they all go to the left, so they will all probably overlap a bit in the scatter plot. 

Making a scatter plot: 
```{r}
newdata <- data.frame(Family = d[,2], lda = lda.predict$x) #make a dataframe with the familiy names and predicts LDs
newdata
library(ggplot2)
ggplot(newdata) + geom_point(aes(lda.LD1, lda.LD2, colour = Family), size = 2.5)
```
They are kind of on top of each other, so I'm going to try to add another variable, mass dimorphism, which we can use the same dataset: 

```{r}
kamcoop.lda.2 <- lda(Family ~ Body_mass_male_mean + Body_mass_female_mean + Mass_Dimorphism, data = d) #categorical dependent variable is family 
lda.predict.2 <- predict(kamcoop.lda.2)
lda.predict.2
newdata.2 <- data.frame(Family = d[,2], lda = lda.predict.2$x) 
newdata.2 #3 LD because 3 variables?
library(ggplot2)
ggplot(newdata.2) + geom_point(aes(lda.LD1, lda.LD2, colour = Family), size = 2.5) 
```
There is a little bit of differentiation between Cebidae and the other two families. This makes sense because Cebidae includes capuchins and squirrel monkeys, which are pretty small in comparison to atelids and cercopithecids.

Brain size???

```{r}
kamcoop.lda.3 <- lda(Family ~ Brain_Size_Species_Mean, data = d) 
lda.predict.3 <- predict(kamcoop.lda.3)
lda.predict.3
newdata.3 <- data.frame(Family = d[,2], lda = lda.predict.2$x) 
newdata.3 
ggplot(newdata.3) + geom_point(aes(lda.LD1, lda.LD2, colour = Family), size = 2.5) 
```

So with all of these variables, we are able to say that body mass and brain size can describe Cebidae out of these three families, but not the other two because they are too similar. 


